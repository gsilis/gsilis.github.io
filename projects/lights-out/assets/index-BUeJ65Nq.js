(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))n(e);new MutationObserver(e=>{for(const s of e)if(s.type==="childList")for(const c of s.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&n(c)}).observe(document,{childList:!0,subtree:!0});function i(e){const s={};return e.integrity&&(s.integrity=e.integrity),e.referrerPolicy&&(s.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?s.credentials="include":e.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(e){if(e.ep)return;e.ep=!0;const s=i(e);fetch(e.href,s)}})();class m{static createFor(o,i){return new m(o,i)}constructor(o,i){this._x=o,this._y=i}get x(){return this._x}get y(){return this._y}compare(o){return o.x==this.x&&o.y==this.y}}class t{static pool=[];static pointFor(o,i){return this.pool[o]=this.pool[o]||[],this.pool[o][i]=this.pool[o][i]||new m(o,i),this.pool[o][i]}}class E{buttons=[];elements=[];constructor(o,i,n){this.dispatcher=new EventTarget,this.buttonFactory=n,this.width=o,this.height=i,this.nullButton=this.buttonFactory.createNull(),window.grid=this}setup(){this.buttons=[];for(let o=0;o<this.height;o++){const i=[];for(let n=0;n<this.width;n++){const e=t.pointFor(n,o),s=this.buttonFactory.create(e);s.addEventListener("CLICK",this.onSelect),i[n]=s,this.elements.push(s)}this.buttons[o]=i}}onSelect=o=>{const i=o.detail.point,n=new CustomEvent("SELECT",{detail:{point:i}});this.dispatcher.dispatchEvent(n)};toggle=o=>{this.buttonAt(o).toggle()};buttonAt=o=>{const{x:i,y:n}=o;return this.buttons[n]&&this.buttons[n][i]||this.nullButton};applyData=o=>{this.clear(),o.forEach(i=>this.toggle(i))};clear=()=>{this.elements.forEach(o=>o.on=!1)};checkedPoints=()=>this.checked().map(o=>o.point);checked=()=>this.elements.filter(o=>o.on);checkedCount=()=>this.checked().length;addEventListener=(...o)=>this.dispatcher.addEventListener(...o);removeEventListener=(...o)=>this.dispatcher.removeEventListener(...o)}const a={WIDTH:5,HEIGHT:5};class v{constructor(o,i,n,e,s,c){this.setState=o,this.pushState=i,this.popState=n,this.grid=e,this.session=s,this.stateFactory=c}setup(){}onSelect(o){}onHint(){}onReset(){}teardown(){}pause(){}resume(){}withOptions(){}}class f extends v{getSequence(){return this.sequence}onSelect(){}teardown(){}}const S=[t.pointFor(0,0),t.pointFor(1,0),t.pointFor(2,0),t.pointFor(3,0),t.pointFor(4,0),t.pointFor(4,1),t.pointFor(4,2),t.pointFor(4,3),t.pointFor(4,4),t.pointFor(3,4),t.pointFor(2,4),t.pointFor(1,4),t.pointFor(0,4),t.pointFor(0,3),t.pointFor(0,2),t.pointFor(0,1),t.pointFor(1,1),t.pointFor(2,1),t.pointFor(3,1),t.pointFor(3,2),t.pointFor(3,3),t.pointFor(2,3),t.pointFor(1,3),t.pointFor(1,2),t.pointFor(2,2)];class d{static create(o){return new d(o)}steps=[];tickNotifiers=[];completionNotifiers=[];index=-1;interval=null;constructor(o){this.stepDurationMS=o}addSteps(...o){return this.steps.push(...o),this}tick(o){return this.tickNotifiers.push(o),this}done(o){return this.completionNotifiers.push(o),this}run(){return this.interval=setInterval(this.onInterval,this.stepDurationMS),this}pause(){return clearInterval(this.interval),this.interval=null,this}reset(){return this.currentIndex=-1,this}onInterval=()=>{const o=this.steps[this.index],i=this.steps[++this.index];if(this.steps.length<=this.index){this.pause(),this.completionNotifiers.forEach(e=>e.call(void 0,this));return}this.tickNotifiers.forEach(e=>e.call(void 0,i,o,this))};removeNotifier(o){const i=this.tickNotifiers.indexOf(o),n=this.completionNotifiers.indexOf(o);i>-1&&this.tickNotifiers.splice(i,1),n>-1&&this.completionNotifiers.splice(n,1)}}const u=function(o,i){const n=o.length;let e=i%n;return e<0&&(e=n+e),o[e]};class L extends f{setup(){const o=u(S,-1);this.sequence=d.create(100).addSteps(...S).tick((i,n)=>{n&&this.grid.toggle(n),this.grid.toggle(i)}).done(()=>{this.grid.toggle(o),this.complete()}).run()}complete=()=>{this.setState(this.stateFactory.create(F.LEVEL_SELECT_ANIMATION))};teardown=()=>{this.grid.clear(),this.sequence.pause()};onSelect=o=>{this.complete()}}class p{repetitive=void 0;points=[];moves=[];constructor(o,i){this.points=o,this.moves=i}addPoint(o){this.points.push(o)}addMove(o){this.moves.push(o)}isRepetitious(){if(this.repetitive!==void 0)return this.repetitive;const o={};return this.repetitive=this.moves.reduce((i,n)=>{const e=`${n.x}|${n.y}`;return!i&&o[e]&&(i=!0),o[e]=!0,i},!1),this.repetitive}}const y=new p([t.pointFor(2,2),t.pointFor(1,2),t.pointFor(3,2),t.pointFor(2,1),t.pointFor(2,3)],[t.pointFor(2,2)]),x=new p([t.pointFor(0,2),t.pointFor(2,2),t.pointFor(4,2)],[t.pointFor(0,3),t.pointFor(2,3),t.pointFor(4,3),t.pointFor(0,4),t.pointFor(2,4),t.pointFor(4,4)]),_=new p([t.pointFor(2,0),t.pointFor(3,0),t.pointFor(4,0),t.pointFor(0,1),t.pointFor(0,2),t.pointFor(1,2),t.pointFor(2,2),t.pointFor(3,2),t.pointFor(4,2),t.pointFor(0,3),t.pointFor(2,4),t.pointFor(3,4),t.pointFor(4,4)],[t.pointFor(0,2),t.pointFor(3,4),t.pointFor(3,0),t.pointFor(3,2)]),I=new p([t.pointFor(1,0),t.pointFor(0,1),t.pointFor(2,1),t.pointFor(3,1),t.pointFor(0,2),t.pointFor(3,2),t.pointFor(4,2),t.pointFor(1,3),t.pointFor(2,4),t.pointFor(3,4),t.pointFor(4,4)],[t.pointFor(1,2),t.pointFor(3,1),t.pointFor(3,2),t.pointFor(3,4),t.pointFor(1,1),t.pointFor(3,1)]),A=new p([t.pointFor(1,0),t.pointFor(3,0),t.pointFor(0,1),t.pointFor(2,1),t.pointFor(3,1),t.pointFor(4,1),t.pointFor(0,2),t.pointFor(1,2),t.pointFor(2,2),t.pointFor(2,3),t.pointFor(3,3),t.pointFor(1,4),t.pointFor(3,4)],[t.pointFor(3,1),t.pointFor(1,2),t.pointFor(2,2),t.pointFor(2,4),t.pointFor(1,1),t.pointFor(2,3)]),N=new p([t.pointFor(2,0),t.pointFor(1,1),t.pointFor(3,1),t.pointFor(3,2),t.pointFor(0,3),t.pointFor(1,3),t.pointFor(3,3),t.pointFor(1,4),t.pointFor(2,4),t.pointFor(3,4),t.pointFor(4,4)],[t.pointFor(2,1),t.pointFor(2,3),t.pointFor(1,3),t.pointFor(2,2),t.pointFor(2,3),t.pointFor(3,4)]),M=new p([t.pointFor(0,0),t.pointFor(1,0),t.pointFor(3,0),t.pointFor(4,0),t.pointFor(1,1),t.pointFor(3,1),t.pointFor(4,1),t.pointFor(1,2),t.pointFor(2,2),t.pointFor(3,2),t.pointFor(4,2),t.pointFor(1,3),t.pointFor(4,4)],[t.pointFor(4,4),t.pointFor(2,2),t.pointFor(1,2),t.pointFor(4,0),t.pointFor(0,1),t.pointFor(1,1),t.pointFor(3,2),t.pointFor(3,3)]),O=new p([t.pointFor(2,0),t.pointFor(3,0),t.pointFor(4,1),t.pointFor(0,2),t.pointFor(3,2),t.pointFor(0,3),t.pointFor(2,3),t.pointFor(1,4)],[t.pointFor(3,3),t.pointFor(1,3),t.pointFor(3,1),t.pointFor(2,1),t.pointFor(3,3),t.pointFor(1,2)]),b=new p([t.pointFor(0,0),t.pointFor(1,0),t.pointFor(3,0),t.pointFor(4,0),t.pointFor(1,1),t.pointFor(1,2),t.pointFor(3,2),t.pointFor(4,2),t.pointFor(0,3),t.pointFor(1,3),t.pointFor(0,4)],[t.pointFor(2,0),t.pointFor(1,0),t.pointFor(4,3),t.pointFor(1,4),t.pointFor(2,3),t.pointFor(4,3),t.pointFor(3,2),t.pointFor(2,2),t.pointFor(2,0),t.pointFor(2,2),t.pointFor(1,3),t.pointFor(3,0)]),T=new p([t.pointFor(1,1),t.pointFor(2,1),t.pointFor(0,2),t.pointFor(1,2),t.pointFor(2,2),t.pointFor(1,3),t.pointFor(4,3),t.pointFor(0,4),t.pointFor(2,4),t.pointFor(3,4)],[t.pointFor(1,2),t.pointFor(1,3),t.pointFor(0,4),t.pointFor(3,3),t.pointFor(2,3),t.pointFor(2,2)]),C=new p([t.pointFor(2,0),t.pointFor(3,0),t.pointFor(0,1),t.pointFor(3,1),t.pointFor(4,1),t.pointFor(1,2),t.pointFor(1,3),t.pointFor(3,3),t.pointFor(4,3),t.pointFor(1,4),t.pointFor(3,4)],[t.pointFor(0,2),t.pointFor(0,3),t.pointFor(3,3),t.pointFor(3,2),t.pointFor(2,3),t.pointFor(3,0),t.pointFor(1,4),t.pointFor(4,1)]),R=new p([t.pointFor(0,0),t.pointFor(1,0),t.pointFor(2,0),t.pointFor(3,0),t.pointFor(0,1),t.pointFor(1,1),t.pointFor(2,1),t.pointFor(3,1),t.pointFor(4,1),t.pointFor(0,2),t.pointFor(1,2),t.pointFor(2,2),t.pointFor(3,2),t.pointFor(4,2),t.pointFor(0,3),t.pointFor(1,3),t.pointFor(4,3),t.pointFor(0,4)],[t.pointFor(0,3),t.pointFor(2,1),t.pointFor(2,0),t.pointFor(1,0),t.pointFor(4,2),t.pointFor(1,1)]),k=new p([t.pointFor(0,0),t.pointFor(1,0),t.pointFor(2,0),t.pointFor(3,0),t.pointFor(4,0),t.pointFor(0,1),t.pointFor(1,1),t.pointFor(3,1),t.pointFor(4,1),t.pointFor(0,2),t.pointFor(1,2),t.pointFor(2,2),t.pointFor(3,2),t.pointFor(4,2),t.pointFor(2,3)],[t.pointFor(2,0),t.pointFor(2,2),t.pointFor(4,1),t.pointFor(0,1)]),$=new p([t.pointFor(0,2),t.pointFor(1,2),t.pointFor(2,2),t.pointFor(1,3),t.pointFor(0,4),t.pointFor(1,4),t.pointFor(3,4),t.pointFor(4,4)],[t.pointFor(3,4),t.pointFor(2,3),t.pointFor(1,3),t.pointFor(0,3)]),H=new p([t.pointFor(1,0),t.pointFor(2,0),t.pointFor(0,1),t.pointFor(0,2),t.pointFor(3,2),t.pointFor(4,2),t.pointFor(2,3),t.pointFor(3,3),t.pointFor(0,4),t.pointFor(1,4)],[t.pointFor(1,1),t.pointFor(3,2),t.pointFor(2,1),t.pointFor(1,3),t.pointFor(0,3)]),D=new p([t.pointFor(1,0),t.pointFor(1,1),t.pointFor(2,1),t.pointFor(4,1),t.pointFor(3,2),t.pointFor(1,3),t.pointFor(2,3),t.pointFor(3,4),t.pointFor(4,4)],[t.pointFor(2,3),t.pointFor(3,1),t.pointFor(2,1),t.pointFor(3,4),t.pointFor(2,0)]),P=new p([t.pointFor(2,0),t.pointFor(4,0),t.pointFor(2,1),t.pointFor(4,1),t.pointFor(4,2),t.pointFor(1,3),t.pointFor(2,3),t.pointFor(0,4),t.pointFor(1,4),t.pointFor(2,4),t.pointFor(3,4),t.pointFor(4,4)],[t.pointFor(3,3),t.pointFor(3,0),t.pointFor(1,4),t.pointFor(4,3),t.pointFor(3,1)]),q=new p([t.pointFor(1,1),t.pointFor(2,1),t.pointFor(0,2),t.pointFor(1,2),t.pointFor(2,2),t.pointFor(3,2),t.pointFor(4,2),t.pointFor(0,3),t.pointFor(1,3),t.pointFor(2,3),t.pointFor(4,3),t.pointFor(1,4),t.pointFor(2,4),t.pointFor(4,4)],[t.pointFor(1,3),t.pointFor(2,3),t.pointFor(2,2),t.pointFor(1,2),t.pointFor(4,3)]),V=new p([t.pointFor(0,0),t.pointFor(1,0),t.pointFor(3,0),t.pointFor(4,0),t.pointFor(0,2),t.pointFor(1,2),t.pointFor(3,2),t.pointFor(4,2),t.pointFor(0,3),t.pointFor(1,3),t.pointFor(3,3),t.pointFor(0,4),t.pointFor(1,4)],[t.pointFor(3,2),t.pointFor(1,2),t.pointFor(1,0),t.pointFor(3,0),t.pointFor(0,4)]),B=new p([t.pointFor(1,0),t.pointFor(3,0),t.pointFor(4,0),t.pointFor(0,1),t.pointFor(1,1),t.pointFor(2,1),t.pointFor(4,1),t.pointFor(1,2),t.pointFor(3,2),t.pointFor(0,3),t.pointFor(1,3),t.pointFor(2,3),t.pointFor(1,4)],[t.pointFor(3,3),t.pointFor(3,1),t.pointFor(4,4),t.pointFor(2,2),t.pointFor(1,2),t.pointFor(3,0),t.pointFor(3,4),t.pointFor(2,4),t.pointFor(0,2),t.pointFor(2,0)]),G=new p([t.pointFor(0,1),t.pointFor(1,1),t.pointFor(2,1),t.pointFor(3,1),t.pointFor(0,2),t.pointFor(2,2),t.pointFor(3,2),t.pointFor(0,3),t.pointFor(2,3),t.pointFor(4,3),t.pointFor(0,4),t.pointFor(3,4)],[t.pointFor(3,3),t.pointFor(0,0),t.pointFor(2,1),t.pointFor(1,4),t.pointFor(2,3),t.pointFor(1,3),t.pointFor(1,2),t.pointFor(1,0)]),W=new p([t.pointFor(1,0),t.pointFor(2,0),t.pointFor(4,0),t.pointFor(0,1),t.pointFor(2,1),t.pointFor(3,1),t.pointFor(4,1),t.pointFor(2,2),t.pointFor(3,2),t.pointFor(4,2),t.pointFor(2,3),t.pointFor(2,4),t.pointFor(3,4),t.pointFor(4,4)],[t.pointFor(0,3),t.pointFor(2,0),t.pointFor(0,2),t.pointFor(3,2),t.pointFor(3,4),t.pointFor(4,0),t.pointFor(0,4),t.pointFor(1,3)]),K=new p([t.pointFor(1,0),t.pointFor(2,0),t.pointFor(3,0),t.pointFor(4,0),t.pointFor(1,1),t.pointFor(2,1),t.pointFor(4,1),t.pointFor(0,2),t.pointFor(3,2),t.pointFor(0,3),t.pointFor(1,3),t.pointFor(2,3),t.pointFor(3,3),t.pointFor(1,4)],[t.pointFor(2,3),t.pointFor(0,2),t.pointFor(3,0),t.pointFor(2,4),t.pointFor(3,3),t.pointFor(4,2),t.pointFor(3,2),t.pointFor(1,1)]),Y=new p([t.pointFor(0,0),t.pointFor(1,0),t.pointFor(2,0),t.pointFor(3,0),t.pointFor(0,1),t.pointFor(1,1),t.pointFor(2,1),t.pointFor(3,1),t.pointFor(4,1),t.pointFor(0,2),t.pointFor(1,2),t.pointFor(2,2),t.pointFor(4,2),t.pointFor(0,3),t.pointFor(1,3),t.pointFor(3,3),t.pointFor(4,3),t.pointFor(0,4),t.pointFor(2,4),t.pointFor(4,4)],[t.pointFor(2,1),t.pointFor(2,2),t.pointFor(3,3),t.pointFor(0,0),t.pointFor(3,1),t.pointFor(3,4),t.pointFor(0,3),t.pointFor(3,2)]),j=new p([t.pointFor(0,0),t.pointFor(1,0),t.pointFor(4,0),t.pointFor(2,1),t.pointFor(0,2),t.pointFor(1,2),t.pointFor(4,2),t.pointFor(1,3),t.pointFor(2,3),t.pointFor(3,3)],[t.pointFor(3,2),t.pointFor(4,2),t.pointFor(3,4),t.pointFor(4,4),t.pointFor(0,1),t.pointFor(1,1),t.pointFor(4,1),t.pointFor(2,3)]),U=[y,x,_,I,A,N,M,O,b,T,C,R,k,$,H,D,P,q,V,B,G,W,K,Y,j];class z extends v{rightMoves=[];wrongMoves=[];snapshot=[];setup(){const o=this.session.level.getCurrentValue();this.levelData=U[o],this.grid.applyData(this.levelData.points)}onSelect(o){const i=o.detail.point,n=u(this.wrongMoves,-1)===i,e=this.levelData.moves[this.rightMoves.length]===i;n?this.wrongMoves.pop():e?this.rightMoves.push(i):this.wrongMoves.push(i),[i,t.pointFor(i.x,i.y-1),t.pointFor(i.x,i.y+1),t.pointFor(i.x-1,i.y),t.pointFor(i.x+1,i.y)].forEach(this.grid.toggle),this.grid.checkedCount()===0&&(this.grid.clear(),this.session.level.update(this.session.level.getCurrentValue()+1),this.setState(this.stateFactory.create(F.LEVEL_SELECT_ANIMATION)))}onReset(){this.setState(this.stateFactory.create(F.PLAY))}onHint(){this.pushState(this.stateFactory.create(F.HINT,this.grid.checkedPoints(),this.levelData.moves,this.rightMoves,this.wrongMoves))}pause(){this.snapshot=this.grid.checkedPoints()}resume(){this.grid.clear(),this.grid.applyData(this.snapshot)}}class J extends v{onSelect(o){const i=o.detail.point,n=this.points.indexOf(i);if(n<0){this.pushState(this.stateFactory.create(F.ERROR_ANIMATION));return}this.session.level.update(n),this.setState(this.stateFactory.create(F.PLAY))}setup(){const o=this.session.maxLevel.getCurrentValue();let i=0;for(this.points=[];i<=o;){const n=i%a.WIDTH,e=Math.floor(i/a.WIDTH);this.points.push(t.pointFor(n,e)),i++}this.grid.clear(),this.points.forEach(n=>{this.grid.toggle(n)})}teardown(){this.grid.clear()}resume(){this.grid.clear(),this.grid.applyData(this.points)}onHint(){this.pushState(this.stateFactory.create(F.ERROR_ANIMATION))}onReset(){this.pushState(this.stateFactory.create(F.ERROR_ANIMATION))}}const l=[t.pointFor(0,0),t.pointFor(1,1),t.pointFor(2,2),t.pointFor(3,3),t.pointFor(4,4),t.pointFor(4,0),t.pointFor(3,1),t.pointFor(1,3),t.pointFor(0,4)],Q=[l,l,l,l,l,l];class X extends f{setup(){this.grid.clear(),this.sequence=d.create(200).addSteps(...Q).tick(o=>{o.forEach(i=>this.grid.toggle(i))}).done(()=>{this.popState()}).run()}teardown=()=>{this.sequence.pause(),this.grid.clear()}}class Z extends f{setup(){const o=this.session.level.getCurrentValue(),i=o%a.WIDTH,n=Math.floor(o/a.HEIGHT),e=t.pointFor(i,n);this.sequence=d.create(200).addSteps(e,e,e,e,e,e,e,e).tick(s=>{this.grid.toggle(s)}).done(this.complete).run()}complete=()=>{this.setState(this.stateFactory.create(F.PLAY))};onSelect=()=>{this.complete()};teardown=()=>{this.sequence.pause(),this.grid.clear()}}class tt extends v{withOptions(o,i,n,e){this.snapshot=o,this.rightMoves=n,this.wrongMoves=e,this.moves=i}setup(){const o=u(this.wrongMoves,-1),i=this.moves[this.rightMoves.length],n=o||i;if(!n){this.setState(this.stateFactory.create(F.ERROR_ANIMATION));return}this.grid.clear(),this.grid.applyData(this.snapshot),this.sequence=d.create(200).addSteps(n,n,n,n,n,n).tick(e=>{this.grid.toggle(e)}).done(()=>{this.popState()}).run()}onSelect(){this.sequence.pause(),this.popState()}teardown(){this.sequence.pause()}}const F={SPIRAL_ANIMATION:L,LEVEL_SELECT_ANIMATION:Z,ERROR_ANIMATION:X,PLAY:z,LEVEL_SELECT:J,HINT:tt};class ot{constructor(o,i,n,e,s){this.setState=o,this.pushState=i,this.popState=n,this.grid=e,this.session=s}create(o,...i){const n=typeof o=="function"&&o||v,e=new n(this.setState,this.pushState,this.popState,this.grid,this.session,this);return e.withOptions(...i),e}}const it=function(o,i){const n=[];for(let e=0;e<o;e++)n.push(i);return n};class g{_value=null;_observers=[];constructor(o){this._value=o}getCurrentValue(){return this._value}observe(o){return this._observers.push(o),o.call(void 0,this._value),this}update(o){return this._value=o,this._observers.forEach(i=>i.call(void 0,o)),this}}class nt{maxLevel=new g(0);level=new g(0);solved=it(a.WIDTH*a.HEIGHT,!1);interactive=new g(!1);setup(){this.level.observe(o=>{const i=this.maxLevel.getCurrentValue();o>i&&this.maxLevel.update(o)})}}class w{_active=!1;constructor(o,i){this.dispatcher=new EventTarget,this._on=!1,this._stage=o,this._point=i,this._html=document.createElement("button"),this._html.setAttribute("data-x",this._point.x),this._html.setAttribute("data-y",this._point.y),this._stage.appendChild(this._html),this._html.addEventListener("click",this.click)}get active(){return this._active}set active(o){this._active=o,this._html.disabled=!this._active}get on(){return this._on}set on(o){this._on=o,this._on?this._html.classList.add("on"):this._html.classList.remove("on")}get point(){return this._point}toggle=()=>{this.on=!this.on};click=()=>{const o=new CustomEvent("CLICK",{detail:{point:this._point}});this.dispatcher.dispatchEvent(o)};addEventListener=(...o)=>this.dispatcher.addEventListener(...o);removeEventListener=(...o)=>this.dispatcher.removeEventListener(...o)}class et{constructor(o){this.stage=o}createNull(){return new w(document.createElement("div"),t.pointFor(-1,-1))}create(o){return new w(this.stage,o)}}class rt{constructor(o,i,n,e){this.state=[],this.session=new nt,this.session.setup(),this.domGrid=o,this.domSelect=i,this.domReset=n,this.domHint=e,this.buttonFactory=new et(this.domGrid),this.grid=new E(a.WIDTH,a.HEIGHT,this.buttonFactory),this.stateFactory=new ot(this.setState,this.pushState,this.popState,this.grid,this.session),this.grid.setup(),this.grid.addEventListener("SELECT",this.onSelect),this.domSelect.addEventListener("click",this.onLevelSelect),this.domReset.addEventListener("click",this.onReset),this.domHint.addEventListener("click",this.onHint),this.setState(this.stateFactory.create(F.SPIRAL_ANIMATION))}onLevelSelect=()=>{this.setState(this.stateFactory.create(F.LEVEL_SELECT))};setState=o=>{const i=this.state.pop();i&&i.teardown(),o.setup(),this.state.push(o)};pushState=o=>{const i=u(this.state,-1);i&&i.pause.call(i),o.setup(),this.state.push(o)};popState=()=>{const o=this.state.pop(),i=u(this.state,-1);o&&o.teardown.call(o),i&&i.resume.call(i)};getLatestState=()=>u(this.state,-1);onSelect=(...o)=>{const i=this.getLatestState();return i.onSelect.call(i,...o)};onHint=(...o)=>{const i=this.getLatestState();return i.onHint.call(i,...o)};onReset=(...o)=>{const i=this.getLatestState();return i.onReset.call(i,...o)}}class st{listeners=[];constructor(...o){this.index=0,this.steps=o}onComplete(o){this.listeners.push(o)}next(...o){this.steps[this.index].call(void 0,...o)?(this.index+=1,this.index>=this.steps.length&&this.complete()):this.index=0}complete(){this.index=0,this.listeners.forEach(o=>o.call(void 0))}}const h=r=>o=>o.key===r;class pt{listeners=[];constructor(){window.addEventListener("keyup",this.onKey),this.chain=new st(h("ArrowUp"),h("ArrowUp"),h("ArrowDown"),h("ArrowDown"),h("ArrowLeft"),h("ArrowRight"),h("ArrowLeft"),h("ArrowRight"),h("a"),h("b")),this.chain.onComplete(this.notify)}onKey=o=>{this.chain.next(o)};observe=o=>{this.listeners.push(o)};unobserve=o=>{this.listeners=this.listeners.filter(i=>i!==o)};notify=()=>{this.listeners.forEach(o=>o.call(void 0))}}function Ft(){const r=document.getElementById("game-reset"),o=document.getElementById("game-select"),i=document.getElementById("game-hint"),n=document.querySelector("#app .grid"),e=new rt(n,o,r,i),s=new pt,c=()=>{e.session.maxLevel.update(25),alert("All levels unlocked!"),s.unobserve(c)};s.observe(c)}document.addEventListener("DOMContentLoaded",function r(){document.removeEventListener("DOMContentLoaded",r),Ft()});
